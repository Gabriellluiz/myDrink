<ion-header>
  <ion-toolbar color="laranja">
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>Cadastre-se</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content color="fundo">


  <div class="padding">
    <form [formGroup]="formCadastro">

      <ion-item color="fundo">
        <ion-avatar *ngIf="downloadUrlUser | async" slot="start">
          <img [src]="downloadUrlUser | async" />
        </ion-avatar>
        <ion-label>Foto de perfil</ion-label>
        <ion-icon (click)="abrirGaleriaUser()" name="images" slot="end"></ion-icon>
      </ion-item>

      <ion-item color="fundo">
        <ion-input color="fundo"  formControlName="foto" readonly>{{downloadUrlUser |
          async}}</ion-input>
      </ion-item> <!--[(ngModel)]="userRegister.foto"-->

      <ion-item>
        <ion-label>Progresso de Upload: {{porcentUp | async}}</ion-label>
      </ion-item>

      <ion-item color="fundo">
        <ion-label class="titulo" position="stacked">Nome completo:</ion-label>
        <ion-input [(ngModel)]="userRegister.nome" formControlName="nome" placeholder="Ex: Gabriel Luiz" type="text"></ion-input>
        <ng-container *ngFor="let erro of mensagens_validacao.nome">
          <span *ngIf="formCadastro.get('nome').hasError(erro.tipo) && (formCadastro.get('nome').dirty || formCadastro.get('nome').touched)"
            class="msg-erro">
            {{erro.mensagem}}
          </span>
        </ng-container>
      </ion-item>


      <ion-item color="fundo">
        <ion-label class="titulo" position="stacked">Data de Nascimento:</ion-label>
        <!-- Utilizando mascara para o campo -->
        <ion-input [(ngModel)]="userRegister.dataNasc" formControlName="dataNascimento" placeholder="dd/mm/yyyy"
          [brmasker]="{form: formCadastro.get('dataNascimento'), mask: '99/99/9999', type:'num'}"></ion-input>
        <ng-container *ngFor="let erro of mensagens_validacao.dataNascimento">
          <span *ngIf="formCadastro.get('dataNascimento').hasError(erro.tipo) && (formCadastro.get('dataNascimento').dirty || formCadastro.get('dataNascimento').touched)"
            class="msg-erro">
            {{erro.mensagem}}
          </span>
        </ng-container>
      </ion-item>


      <ion-item color="fundo">
        <ion-label class="titulo" position="stacked">Email:</ion-label>
        <ion-input [(ngModel)]="userRegister.usuario" formControlName="email" placeholder="Ex: mydrink@suport.com" type="email"></ion-input>
        <ng-container *ngFor="let erro of mensagens_validacao.email">
          <span *ngIf="formCadastro.get('email').hasError(erro.tipo) && (formCadastro.get('email').dirty || formCadastro.get('email').touched)"
            class="msg-erro">
            {{erro.mensagem}}
          </span>
        </ng-container>
      </ion-item>


      <ion-item color="fundo">
        <ion-label class="titulo" position="stacked">Senha:</ion-label>
        <ion-input [(ngModel)]="userRegister.senha" formControlName="senha" placeholder="Min. 6 caracteres" type="password"></ion-input>
        <ng-container *ngFor="let erro of mensagens_validacao.senha">
          <span *ngIf="formCadastro.get('senha').hasError(erro.tipo) && (formCadastro.get('senha').dirty || formCadastro.get('senha').touched)"
            class="msg-erro">
            {{erro.mensagem}}
          </span>
        </ng-container>
      </ion-item>


      <ion-item color="fundo">
        <ion-label class="titulo" position="stacked">Confirmar Senha:</ion-label>
        <ion-input formControlName="confirmaSenha" placeholder="Digite a senha novamente" type="password"></ion-input>
        <ng-container *ngFor="let erro of mensagens_validacao.confirmaSenha">
          <span *ngIf="formCadastro.get('confirmaSenha').hasError(erro.tipo) && (formCadastro.get('confirmaSenha').dirty || formCadastro.get('confirmaSenha').touched)"
            class="msg-erro">
            {{erro.mensagem}}
          </span>
        </ng-container>
      </ion-item>

    </form>

    <div class="espaco-acima"></div>

    <ion-button (click)="registrar()" color="laranja" expand="block" fill="outline">Confirmar Cadastro</ion-button>
  </div>

</ion-content>